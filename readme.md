# SOCSSO
### A socket based SSO solution designed for ITRClub Tech ORG

这是一款后端间基于socket通信的中心化指令集的异步实时SSO用户管理侧系统

## 功能与特征
* **统一生态群内所有系统的所有用户状态**(登陆/注销/覆盖登陆/超时登出等)
* **统一生态群内的所有用户基本资料特性**(注册/密码/昵称/电话邮箱/消费信息等)
* 基于swoole异步通信框架，双向socket通信管道
* 多线程、多进程，稳健、低占用的进程架构
* 中心化用户服务器，依托中心化且全局的检验机制，规避风险
* 低耦合客户端调用方式，**开发者只需要考虑调用函数，无需关心实现方式**，简单接入，功能强大

## 目录&程序架构
* Central_server 为**用户中心服务器CUS**，管理用户核心资料和生态群用户状态监听、广播等事务，只需要运行于php-cli，配置好数据库即可轻松创建CUS进程
* Client 为客户端文件，配备socket守护进程客户端和子系统函数库，子系统只需要加载函数库，运行守护进程，并配置关键数据表就可轻松接入SOCSSO

## 首次运行

### 必须先运行CUS中心服务器
1. clone
2. chmod 赋予目录权限
3. 下载数据库结构文件，导入，并在Main.php填写必要信息
4. php Main.php 即可以守护进程方式运行，进程会自主维护
5. 日志：生成在运行目录的CUS.log内

### Client端的守护进程启动

### 加载函数库

### 接入开发者只需要熟悉Client端的函数库用法
SOCSSO的接入开发者只需要调用函数库内的函数，即可对所有接入了SOCSSO的系统的用户数据统一操作，无需考虑实现方式  
详细用法，请见WIKI

## 二次开发必读

### 后端间指令集[重要]
“SOCSSO的指令集”可以理解为SOCSSO系统间数据接口，CUS和Client依靠于双方认同的指令集进行所有操作，指令集包括：
* 用户状态增删改(登陆/注销/覆盖登陆/超时登出等)
* 用户信息增删改查
**必须仔细阅读，因为系统间不配备指令集的检验过程，非法的指令集将可能引发不可恢复的严重错误！**  
[WIKI跳转](http://dev.itrclub.com/LYJSpeedX/SOCSSO/wiki/_pages)

#### 指令集的实现原理
CUS与Client的守护进程负责监听socket和往socket发送指令  
指令的维护依靠守护进程内的定时器轮询数据库实现